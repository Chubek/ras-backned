/* Authored by Chubak Bidpaa: chubakbidpaa@gmail.com --- April 2020, Corona Times */

const jwt = require("jsonwebtoken");
require("dotenv").config({ path: appRoot + "/.env" });

function Placeholder(req, res, next) {
const token = req.header("x-auth-token-Placeholder");

if (!token)
return res.status(401).json({ message: "No token, access denied." });

try {
const decoded = jwt.verify(token, process.env.JWT_SECRET);
req.Placeholder = decoded;
next();
} catch {
res.status(400).json({ message: "Token is not valid" });
}
}

module.exports = Placeholder;